<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${pageTitle}">Tableau de bord - Banque Premium</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body th:replace="~{base :: layout(~{::title}, ~{::section})}">
<section>
    <div class="page-content">
        <div class="container">
            <!-- Messages d'alerte -->
            <div th:if="${session.successMessage != null}" class="alert alert-success">
                <span th:text="${session.successMessage}">Message de succès</span>
            </div>
            
            <div th:if="${session.errorMessage != null}" class="alert alert-danger">
                <span th:text="${session.errorMessage}">Message d'erreur</span>
            </div>

            <!-- Section d'accueil -->
            <div class="dashboard__welcome">
                <h1 class="dashboard__title">
                    Bonjour <span th:text="${clientPrenom}">John</span> ! 👋
                </h1>
                <p class="dashboard__subtitle">
                    Bienvenue dans votre espace bancaire personnel. Gérez vos comptes et opérations en toute sécurité.
                </p>
            </div>

            <!-- Grille des comptes et actions -->
            <div class="dashboard__grid">
                <!-- Carte des comptes -->
                <div class="card compte-info" th:if="${hasComptes == true}">
                    <div class="card__header">
                        <h2 class="card__title">💳 Mes Comptes</h2>
                        <span class="card__icon">💰</span>
                    </div>
                    <div class="card__content">
                        <!-- Liste des comptes -->
                        <div th:each="compte : ${comptes}" class="compte-item" style="margin-bottom: 1rem; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 8px;">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <strong th:text="${compte.numeroCompte}">N° 123456789</strong>
                                    <br>
                                    <small th:text="${compte.typeCompte != null ? compte.typeCompte : 'Compte Standard'}">Compte Standard</small>
                                </div>
                                <div class="text-right">
                                    <div class="solde-amount" th:text="${compte.solde != null ? #numbers.formatCurrency(compte.solde) : '0,00 €'}">1 250,00 €</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Message si pas de comptes -->
                <div class="card" th:unless="${hasComptes == true}">
                    <div class="card__header">
                        <h2 class="card__title">💳 Mes Comptes</h2>
                        <span class="card__icon">📋</span>
                    </div>
                    <div class="card__content">
                        <p>Vous n'avez pas encore de compte bancaire.</p>
                        <p class="text-muted">Créez votre premier compte pour commencer à utiliser nos services.</p>
                        <div class="mt-3">
                            <a th:href="@{/nouveau-compte}" class="btn btn-gold">
                                ✨ Créer un compte
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Actions rapides -->
                <div class="card">
                    <div class="card__header">
                        <h2 class="card__title">⚡ Actions Rapides</h2>
                        <span class="card__icon">🚀</span>
                    </div>
                    <div class="card__content">
                        <div class="actions-grid">
                            <a th:if="${hasComptes}" th:href="@{/depot}" class="action-btn">
                                <span class="action-btn__icon">💰</span>
                                Dépôt
                            </a>
                            <span th:unless="${hasComptes}" class="action-btn disabled" style="cursor: not-allowed; opacity: 0.5;">
                                <span class="action-btn__icon">💰</span>
                                Dépôt
                            </span>
                            
                            <a th:if="${hasComptes}" th:href="@{/retrait}" class="action-btn">
                                <span class="action-btn__icon">💸</span>
                                Retrait
                            </a>
                            <span th:unless="${hasComptes}" class="action-btn disabled" style="cursor: not-allowed; opacity: 0.5;">
                                <span class="action-btn__icon">💸</span>
                                Retrait
                            </span>
                            
                            <a th:if="${hasComptes}" th:href="@{/virement}" class="action-btn">
                                <span class="action-btn__icon">🔄</span>
                                Virement
                            </a>
                            <span th:unless="${hasComptes}" class="action-btn disabled" style="cursor: not-allowed; opacity: 0.5;">
                                <span class="action-btn__icon">🔄</span>
                                Virement
                            </span>
                            
                            <a th:unless="${hasComptes}" th:href="@{/nouveau-compte}" class="action-btn">
                                <span class="action-btn__icon">➕</span>
                                Nouveau compte
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Historique récent -->
                <div class="card" th:if="${hasComptes}">
                    <div class="card__header">
                        <h2 class="card__title">📊 Opérations Récentes</h2>
                        <span class="card__icon">📈</span>
                    </div>
                    <div class="card__content">
                        <p class="text-muted">Consultez vos opérations et soldes détaillés</p>
                        <div class="mt-3">
                            <a th:href="@{/solde}" class="btn btn-outline" style="margin-right: 1rem;">
                                💰 Voir mes soldes
                            </a>
                            <a th:href="@{/historique}" class="btn btn-outline">
                                📋 Voir l'historique complet
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Informations personnelles -->
                <div class="card">
                    <div class="card__header">
                        <h2 class="card__title">👤 Mon Profil</h2>
                        <span class="card__icon">⚙️</span>
                    </div>
                    <div class="card__content">
                        <p><strong>Nom complet :</strong> <span th:text="${clientPrenom} + ' ' + ${clientNom}">John Doe</span></p>
                        <p><strong>Statut :</strong> <span class="text-gold">Client Premium</span></p>
                        <p><strong>Membre depuis :</strong> Octobre 2025</p>
                        
                        <div class="mt-3">
                            <a href="#" class="btn btn-outline" style="width: 100%;">
                                Modifier mes informations
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Script spécifique au dashboard -->
    <script>
        // Animations des cartes au scroll
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.card');
            
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.transform = 'translateY(0)';
                        entry.target.style.opacity = '1';
                    }
                });
            }, observerOptions);
            
            cards.forEach(card => {
                card.style.transform = 'translateY(20px)';
                card.style.opacity = '0';
                card.style.transition = 'all 0.6s ease';
                observer.observe(card);
            });
        });
    </script>
</section>
</body>
</html>